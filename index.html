<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Bank PO Mock Test Tracker with Chart</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
    background: #f0f8ff;
  }
  h1 {
    color: #007bff;
  }
  form {
    background: white;
    padding: 15px;
    border-radius: 8px;
    max-width: 700px;
    margin-bottom: 20px;
  }
  label {
    display: block;
    margin-top: 10px;
  }
  input, select, textarea {
    width: 100%;
    padding: 7px;
    margin-top: 5px;
    border-radius: 4px;
    border: 1px solid #ccc;
    box-sizing: border-box;
  }
  button, .action-btn {
    margin-top: 15px;
    background-color: #007bff;
    border: none;
    color: white;
    padding: 8px 12px;
    cursor: pointer;
    border-radius: 4px;
  }
  .action-btn {
    margin: 0 3px;
    padding: 4px 8px;
  }
  button:hover, .action-btn:hover {
    background-color: #0056b3;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    border-radius: 8px;
  }
  th, td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: center;
  }
  th {
    background-color: #007bff;
    color: white;
  }
  #summary {
    background: white;
    padding: 15px;
    border-radius: 8px;
    max-width: 700px;
    margin-top: 10px;
  }
  #chartContainer {
    max-width: 700px;
    margin-top: 20px;
    background: white;
    padding: 15px;
    border-radius: 8px;
  }
</style>
</head>
<body>

<h1>Bank PO Mock Test Tracker with Chart</h1>

<form id="mockTestForm">
  <input type="hidden" id="editIndex" value="-1" />
  <label for="platform">Test Platform (e.g., Testbook, Guidely)</label>
  <input type="text" id="platform" name="platform" required />

  <label for="date">Test Date</label>
  <input type="date" id="date" name="date" required />

  <label for="totalScore">Total Score</label>
  <input type="number" id="totalScore" name="totalScore" min="0" required />

  <label for="quantScore">Quantitative Score</label>
  <input type="number" id="quantScore" name="quantScore" min="0" required />

  <label for="reasoningScore">Reasoning Score</label>
  <input type="number" id="reasoningScore" name="reasoningScore" min="0" required />

  <label for="englishScore">English Score</label>
  <input type="number" id="englishScore" name="englishScore" min="0" required />

  <label for="percentile">Percentile</label>
  <input type="number" id="percentile" name="percentile" min="0" max="100" step="0.01" required />

  <label for="accuracy">Accuracy (%)</label>
  <input type="number" id="accuracy" name="accuracy" min="0" max="100" step="0.01" required />

  <button type="submit">Save Test</button>
</form>

<input type="text" id="searchInput" placeholder="Search by Platform..." />

<table id="testsTable">
  <thead>
    <tr>
      <th>Platform</th>
      <th>Date</th>
      <th>Total Score</th>
      <th>Quant Score</th>
      <th>Reasoning Score</th>
      <th>English Score</th>
      <th>Percentile</th>
      <th>Accuracy (%)</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<div id="summary">
  <h3>Summary</h3>
  <p id="avgTotal">Average Total Score: N/A</p>
  <p id="avgQuant">Average Quant Score: N/A</p>
  <p id="avgReasoning">Average Reasoning Score: N/A</p>
  <p id="avgEnglish">Average English Score: N/A</p>
</div>

<div id="chartContainer">
  <canvas id="scoreChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const form = document.getElementById('mockTestForm');
  const tableBody = document.querySelector('#testsTable tbody');
  const searchInput = document.getElementById('searchInput');
  const avgTotal = document.getElementById('avgTotal');
  const avgQuant = document.getElementById('avgQuant');
  const avgReasoning = document.getElementById('avgReasoning');
  const avgEnglish = document.getElementById('avgEnglish');

  let tests = JSON.parse(localStorage.getItem('mockTests')) || [];

  let scoreChart;

  function renderTests(filter = '') {
    tableBody.innerHTML = '';
    const filteredTests = tests.filter(t => t.platform.toLowerCase().includes(filter.toLowerCase()));
    filteredTests.sort((a,b) => new Date(a.date) - new Date(b.date));
    filteredTests.forEach(test => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${test.platform}</td>
        <td>${test.date}</td>
        <td>${test.totalScore}</td>
        <td>${test.quantScore}</td>
        <td>${test.reasoningScore}</td>
        <td>${test.englishScore}</td>
        <td>${test.percentile}</td>
        <td>${test.accuracy}</td>
      `;
      tableBody.appendChild(row);
    });
    updateSummary(filteredTests);
    renderChart(filteredTests);
  }

  function updateSummary(data) {
    if (data.length === 0) {
      avgTotal.textContent = 'Average Total Score: N/A';
      avgQuant.textContent = 'Average Quant Score: N/A';
      avgReasoning.textContent = 'Average Reasoning Score: N/A';
      avgEnglish.textContent = 'Average English Score: N/A';
      return;
    }
    avgTotal.textContent = 'Average Total Score: ' + (data.reduce((sum, t) => sum + t.totalScore, 0)/data.length).toFixed(2);
    avgQuant.textContent = 'Average Quant Score: ' + (data.reduce((sum, t) => sum + t.quantScore, 0)/data.length).toFixed(2);
    avgReasoning.textContent = 'Average Reasoning Score: ' + (data.reduce((sum, t) => sum + t.reasoningScore, 0)/data.length).toFixed(2);
    avgEnglish.textContent = 'Average English Score: ' + (data.reduce((sum, t) => sum + t.englishScore, 0)/data.length).toFixed(2);
  }

  function renderChart(data) {
    const labels = data.map(t => t.date);
    const scores = data.map(t => t.totalScore);

    if (scoreChart) scoreChart.destroy();

    const ctx = document.getElementById('scoreChart').getContext('2d');
    scoreChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: labels,
        datasets: [{
          label: 'Total Score',
          data: scores,
          borderColor: '#007bff',
          backgroundColor: 'rgba(0,123,255,0.2)',
          fill: true,
          tension: 0.3,
          pointRadius: 5,
          pointHoverRadius: 7
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: { beginAtZero: true }
        },
        interaction: {
          mode: 'nearest',
          intersect: false
        }
      }
    });
  }

  form.addEventListener('submit', e => {
    e.preventDefault();
    const newTest = {
      platform: form.platform.value.trim(),
      date: form.date.value,
      totalScore: Number(form.totalScore.value),
      quantScore: Number(form.quantScore.value),
      reasoningScore: Number(form.reasoningScore.value),
      englishScore: Number(form.englishScore.value),
      percentile: Number(form.percentile.value),
      accuracy: Number(form.accuracy.value)
    };
    tests.push(newTest);
    localStorage.setItem('mockTests', JSON.stringify(tests));
    form.reset();
    renderTests(searchInput.value);
  });

  searchInput.addEventListener('input', () => {
    renderTests(searchInput.value);
  });

  renderTests();
</script>

</body>
</html>
