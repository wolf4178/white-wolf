<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>White Wolf Chat</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #chatBox { border: 1px solid #ccc; height: 300px; overflow-y: scroll; padding: 10px; margin-bottom: 10px; }
    .message { margin: 5px 0; }
    .me { color: blue; }
    .other { color: green; }
  </style>
</head>
<body>
  <h1>White Wolf Chat ðŸš€</h1>
  
  <input type="text" id="username" placeholder="Your name" />
  <button onclick="setUsername()">Set Name</button>
  
  <div id="chatBox"></div>
  
  <input type="text" id="messageInput" placeholder="Type a message..." />
  <button onclick="sendMessage()">Send</button>

  <script type="module">
    // Firebase imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
    import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-database.js";

    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyBaQQoCQ6pOlXxWGmeFa8DNF3ZieFN4JNs",
      authDomain: "white-wolf-social-media.firebaseapp.com",
      databaseURL: "https://white-wolf-social-media-default-rtdb.firebaseio.com/", // <-- Add database URL
      projectId: "white-wolf-social-media",
      storageBucket: "white-wolf-social-media.appspot.com",
      messagingSenderId: "245248562952",
      appId: "1:245248562952:web:088741550a5e2e28c7febd"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    let username = null;

    function setUsername() {
      const input = document.getElementById('username').value.trim();
      if (input) {
        username = input;
        alert("Username set as: " + username);
      } else {
        alert("Enter a valid name!");
      }
    }

    // Send message function
    function sendMessage() {
      const messageInput = document.getElementById('messageInput');
      const text = messageInput.value.trim();
      if (!text || !username) {
        alert("Set your name and type a message!");
        return;
      }

      push(ref(db, 'messages'), {
        user: username,
        text: text,
        timestamp: Date.now()
      });

      messageInput.value = '';
    }

    // Display messages in real-time
    const chatBox = document.getElementById('chatBox');
    onChildAdded(ref(db, 'messages'), (snapshot) => {
      const msg = snapshot.val();
      const div = document.createElement('div');
      div.classList.add('message');
      div.classList.add(msg.user === username ? 'me' : 'other');
      div.textContent = msg.user + ": " + msg.text;
      chatBox.appendChild(div);
      chatBox.scrollTop = chatBox.scrollHeight;
    });
  </script>
</body>
</html>
